<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>筋トレ記録</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f2f2f2;
      margin: 0;
      padding: 2rem;
      color: #333;
    }

    h1 {
      text-align: center;
      color: #444;
    }

    .form-section {
      max-width: 600px;
      margin: 0 auto 2rem;
      background: white;
      padding: 1rem 2rem;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }

    label {
      display: block;
      margin-top: 1rem;
      font-weight: bold;
    }

    input, select, button {
      width: 100%;
      padding: 0.5rem;
      margin-top: 0.25rem;
      font-size: 1rem;
      border-radius: 6px;
      border: 1px solid #ccc;
    }

    button {
      margin-top: 1rem;
      background-color: #4CAF50;
      color: white;
      cursor: pointer;
    }

    button:hover {
      background-color: #45a049;
    }

    .record-section {
      max-width: 800px;
      margin: 0 auto;
    }

    .date-group {
      background-color: #fff;
      margin-bottom: 1.5rem;
      padding: 1rem;
      border-radius: 10px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .date-title {
      font-size: 1.2rem;
      font-weight: bold;
      color: #333;
      border-bottom: 1px solid #ccc;
      padding-bottom: 0.5rem;
    }

    .exercise-group {
      margin-top: 0.75rem;
      padding-left: 1rem;
    }

    .exercise-title {
      font-weight: bold;
      color: #555;
      margin-bottom: 0.25rem;
    }

    ul.record-list {
      list-style: none;
      padding-left: 1.5rem;
    }

    .record-list li {
      margin-bottom: 0.4rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .delete-btn {
      background-color: #e74c3c;
      border: none;
      padding: 0.3rem 0.6rem;
      color: white;
      border-radius: 4px;
      cursor: pointer;
    }

    .delete-btn:hover {
      background-color: #c0392b;
    }
  </style>
</head>
<body>
  <h1>筋トレ記録</h1>
  <div class="form-section">
    <label>日付:</label>
    <input type="date" id="datePicker">

    <label>種目名:</label>
    <select id="exerciseSelect"></select>
    <input type="text" id="newExercise" placeholder="新しい種目を追加">
    <button onclick="addExercise()">種目を追加</button>

    <label>重さ(kg):</label>
    <input type="number" id="weightInput">

    <label>回数:</label>
    <input type="number" id="repsInput">

    <label>セット数:</label>
    <input type="number" id="setsInput">

    <button onclick="saveRecord()">記録を保存</button>
  </div>

  <div class="record-section" id="recordSection"></div>

  <script>
    let records = JSON.parse(localStorage.getItem('trainingRecords')) || [];
    let exercises = JSON.parse(localStorage.getItem('exerciseList')) || ["ベンチプレス", "スクワット", "デッドリフト"];

    const datePicker = document.getElementById("datePicker");
    const exerciseSelect = document.getElementById("exerciseSelect");
    const newExercise = document.getElementById("newExercise");
    const weightInput = document.getElementById("weightInput");
    const repsInput = document.getElementById("repsInput");
    const setsInput = document.getElementById("setsInput");
    const recordSection = document.getElementById("recordSection");

    function renderExerciseOptions() {
      exerciseSelect.innerHTML = "";
      exercises.forEach(ex => {
        const option = document.createElement("option");
        option.value = ex;
        option.textContent = ex;
        exerciseSelect.appendChild(option);
      });
    }

    function addExercise() {
      const newEx = newExercise.value.trim();
      if (newEx && !exercises.includes(newEx)) {
        exercises.push(newEx);
        localStorage.setItem('exerciseList', JSON.stringify(exercises));
        newExercise.value = "";
        renderExerciseOptions();
      }
    }

    function saveRecord() {
      const date = datePicker.value;
      const exercise = exerciseSelect.value;
      const weight = weightInput.value;
      const reps = repsInput.value;
      const sets = setsInput.value;
      if (!date || !exercise || !weight || !reps || !sets) return;

      records.push({ date, exercise, weight, reps, sets });
      localStorage.setItem('trainingRecords', JSON.stringify(records));
      renderRecords();

      weightInput.value = "";
      repsInput.value = "";
      setsInput.value = "";
    }

    function deleteRecord(index) {
      records.splice(index, 1);
      localStorage.setItem('trainingRecords', JSON.stringify(records));
      renderRecords();
    }

    function renderRecords() {
      const grouped = {};
      records.forEach((rec, i) => {
        if (!grouped[rec.date]) grouped[rec.date] = {};
        if (!grouped[rec.date][rec.exercise]) grouped[rec.date][rec.exercise] = [];
        grouped[rec.date][rec.exercise].push({ ...rec, index: i });
      });

      recordSection.innerHTML = "";
      Object.keys(grouped).sort().forEach(date => {
        const dateDiv = document.createElement("div");
        dateDiv.className = "date-group";

        const dateTitle = document.createElement("div");
        dateTitle.className = "date-title";
        dateTitle.textContent = date;
        dateDiv.appendChild(dateTitle);

        Object.keys(grouped[date]).forEach(ex => {
          const exDiv = document.createElement("div");
          exDiv.className = "exercise-group";

          const exTitle = document.createElement("div");
          exTitle.className = "exercise-title";
          exTitle.textContent = ex;
          exDiv.appendChild(exTitle);

          const ul = document.createElement("ul");
          ul.className = "record-list";

          grouped[date][ex].forEach(rec => {
            const li = document.createElement("li");
            li.innerHTML = `重さ: ${rec.weight}kg / 回数: ${rec.reps} / セット: ${rec.sets}
              <button class="delete-btn" onclick="deleteRecord(${rec.index})">削除</button>`;
            ul.appendChild(li);
          });
          exDiv.appendChild(ul);
          dateDiv.appendChild(exDiv);
        });

        recordSection.appendChild(dateDiv);
      });
    }

    renderExerciseOptions();
    renderRecords();
  </script>
</body>
</html>
